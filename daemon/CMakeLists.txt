INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/common)
INCLUDE_DIRECTORIES(${CMAKE_SOURCE_DIR}/lib/include)

SET(OCLIB "oc")
SET(OCLOGGER "oc_logger")
SET(OCLOGGER_CORE "oc_logger_core")
SET(COAP "coap")
SET(OCTBSTACK "octbstack")

FILE(GLOB DAEMON_SRCS *.c *.cpp)

pkg_check_modules(daemon_pkgs REQUIRED gio-2.0 dlog)
INCLUDE_DIRECTORIES(${daemon_pkgs_INCLUDE_DIRS})
LINK_DIRECTORIES(${daemon_pkgs_LIBRARY_DIRS})

ADD_DEFINITIONS("-DIOTCON_DBUS_INTERFACE=\"${DBUS_INTERFACE}\"")

ADD_EXECUTABLE(${DAEMON} ${DAEMON_SRCS})
TARGET_LINK_LIBRARIES(${DAEMON} ${daemon_pkgs_LIBRARIES} ${OCLIB} ${OCLOGGER}
	${OCLOGGER_CORE} ${COAP} ${OCTBSTACK})

INSTALL(TARGETS ${DAEMON} DESTINATION ${BIN_INSTALL_DIR})

SET(DBUS_SERVICE_FILE "org.tizen.${PROJECT_NAME}")
CONFIGURE_FILE(${DBUS_SERVICE_FILE}.service.in ${DBUS_SERVICE_FILE}.service @ONLY)
INSTALL(FILES ${DBUS_SERVICE_FILE}.service DESTINATION ${SHARE_INSTALL_PREFIX}/dbus-1/services)
